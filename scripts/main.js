"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(e){return m.text[e][m.language]}function n(){f.current>0&&f.current<f.len-1?(f.current-=1,i(f.current),f.current>0&&$("#n-header__close").addClass("on")):t()}function t(){"session"===f.page&&f.hasSingleSession===!1?(f.page="course",f.current=0,document.body.className="n-in-course-intro",document.getElementById("n-header-title").innerHTML=f.courseTitle):(f.page="",document.body.className="",document.getElementById("n-header-title").innerHTML=e("appTitle"))}function s(e){for(var n=e.length-1;n>0;n--){var t=Math.floor(Math.random()*(n+1)),s=e[n];e[n]=e[t],e[t]=s}return e}function i(n){var t=$("#n-course-inner .n-page"),s=t.eq(n),i=$("#n-course-button"),o=0,a="",r="",l=$("#n-progress-inner .n-progress"),c=s.find(".n-overflow-scroll-y"),d=c.find(".n-overflow-scroll-y-inner"),u=0,v=0;l.removeClass("on"),l.slice(0,n).addClass("on done"),f.current=n,t.removeClass("n-page-on").removeClass("n-page-next").removeClass("n-page-prev"),s.addClass("n-page-on"),n>0?t.eq(f.current-1).addClass("n-page-prev"):0===f.current&&t.eq(f.len-1).addClass("n-page-prev"),n===f.len-1?(t.eq(0).addClass("n-page-next"),f.fullScore>0&&s.hasClass("done")===!1&&(o=100*f.score/f.fullScore,o=Math.round(o),f.scoreRate=o,a=o>=f.passMark?"good":"bad",$.each(f.wrongPoints,function(e,n){r+='<li class="n-wrong-point">'+n+"</li>"}),$.each(f.rightPoints,function(e,n){r+='<li class="n-right-point">'+n+"</li>"}),r="<ul>"+r+"</ul>",s.find(".n-page-title").html(e("scoreIntro")+'<span class="'+a+'">'+o+"%</span>"),s.find(".n-page-lead").html("<div>"+e("pointsIntro")+"</div>"+r)),s.addClass("done")):f.current<f.len-1&&t.eq(f.current+1).addClass("n-page-next"),n===f.len-1?(i.removeClass("disabled"),f.buttonDisable=!1,f.scoreRate>=f.passMark?(f.action="nextSession",i.html(e("nextSession"))):(f.action="retry",i.html(e("retry")))):s.hasClass("n-page-quiz")!==!0&&s.hasClass("n-page-true-false")!==!0||s.hasClass("done")!==!1?(i.html(e(n===f.len-1?"review":0===n?"start":"next")),i.removeClass("disabled"),f.buttonDisable=!1,f.action="next"):(i.html(e("confirm")),i.addClass("disabled"),f.buttonDisable=!0,f.action="confirm"),$("#n-header__close").removeClass("on"),c.hasClass("ftscroller-on")===!1&&c.length>0&&d.length>0&&(u=c.innerHeight(),v=d.outerHeight(),(u<v||c.hasClass("n-overflow-scroll-force")===!0)&&(p[n]=new FTScroller(c.get(0),g),c.addClass("ftscroller-on")))}function o(e,n){var t=e.replace(/^.*course\//g,""),s="api/courses/course"+t+"/index.json",i=0;f.hasSingleSession=!1,f.page="course",f.courseId=t,f.courseTitle=n,document.getElementById("n-course-intro-inner").innerHTML='<div class="n-loading">加载中...</div>',void 0!==("undefined"==typeof n?"undefined":_typeof(n))&&(document.getElementById("n-header-title").innerHTML=n),document.body.className="n-in-course-intro",$.get(s,function(e){var n="";f.courseIntro=e,i=e.content.length,1===i&&1===e.content[0].sessions.length&&(f.hasSingleSession=!0),f.hasSingleSession===!1?($.each(e.content,function(e,t){n+='<div class="n-chapter-title">'+t.title+"</div>",$.each(t.sessions,function(e,t){n+='<div session-id="'+t.id+'" class="n-session-title">'+t.title+"</div>"})}),document.getElementById("n-course-intro-inner").innerHTML=n,"object"!==("undefined"==typeof d?"undefined":_typeof(d))&&(d=new FTScroller(document.getElementById("n-course-intro-container"),g))):a(e.content[0].sessions[0].id,e.content[0].sessions[0].title)}).fail(function(){document.getElementById("n-course-intro-inner").innerHTML='<div class="n-loading">加载失败，可能是我们的服务器不给力，也可能是您的网络不给力。</div>'})}function a(n,t){var o=n.replace(/^.*\/course\//g,""),a="api/courses/course"+f.courseId+"/session"+o+".json";f.page="session",p=[],document.getElementById("n-course-inner").innerHTML='<div class="spinner"><div class="dot1"></div><div class="dot2"></div></div>',void 0!==("undefined"==typeof t?"undefined":_typeof(t))&&(document.getElementById("n-header-title").innerHTML=t),f.currentSession=o,document.getElementById("n-course-button").innerHTML=e("start"),document.body.className="n-in-course",document.getElementById("n-header__score").innerHTML='<div class="n-battery-container" id="n-battery-container"><div class="n-battery-inner" id="n-battery-inner"></div></div>',$.get(a,function(n){var t="",a="",l="",c="api/courses/course"+n.course+"/index.json";f.len=0,f.score=0,f.lostScore=0,f.fullScore=0,f.wrongPoints=[],f.rightPoints=[],f.courseId=n.course,document.getElementById("n-header-title").innerHTML=n.title,n.image&&""!==n.image&&(l='<div class="n-page-image-container"><div class="n-page-image-inner" style="background-image: url('+n.image+')"></div></div>'),n.passMark&&""!==n.passMark&&(f.passMark=parseInt(n.passMark,10)||60),t='<div class="n-page n-page-start n-page-on"><div class="n-page-inner n-overflow-scroll-y"><div class="n-card-container n-overflow-scroll-y-inner"><div class="n-card-inner">'+l+'<h1 class="n-page-title">'+n.title+'</h1><div class="n-page-lead">'+n.lead+"</div></div></div></div></div>",f.len+=1,$.each(n.content,function(n,i){var o="",r="",l="",c=[],d="",u=0,v="",g="",p="",m="",h="",y=0;g=i.explain||"",""!==g&&(g='<div class="n-page-explain animated running fadeInLeft">'+g+"</div>"),v=i.point||"",""!==v&&(v='<div class="n-page-point">'+v+"</div>"),"quiz"===i.pageType?(o='<h3 class="n-page-title">'+i.title+"</h3>",r='<div class="n-page-lead">'+i.question+"</div>",u=parseInt(i.value,10)||1,c.push('<div class="n-option" value='+u+">"+i.rightanswer+"</div>"),$.each(i.wronganswer,function(e,n){c.push('<div class="n-option">'+n+"</div>")}),i.randomize!==!1&&(c=s(c)),$.each(c,function(e,n){l+=n}),l='<div class="n-option-container">'+l+"</div>",t+='<div class="n-page n-page-quiz"><div class="n-page-inner n-overflow-scroll-y"><div class="n-overflow-scroll-y-inner">'+o+r+l+v+g+"</div></div></div>"):"trueOrFalse"===i.pageType?(m="",h="",u=parseInt(i.value,10)||1,i.rightanswer===!0?m=" value="+u:h=" value="+u,o='<h3 class="n-page-title">'+e("trueOrFalse")+"</h3>",r='<div class="n-page-lead">'+i.question+"</div>",u=parseInt(i.value,10)||1,l='<div class="n-true"'+m+">"+e("trueStatement")+'</div><div class="n-false"'+h+">"+e("falseStatement")+"</div>",l='<div class="n-true-false-container">'+l+"</div>",t+='<div class="n-page n-page-true-false"><div class="n-page-inner"><div class="n-card-container"><div class="n-card-inner">'+o+r+l+v+g+"</div></div></div></div>"):"list"===i.pageType?(o='<h3 class="n-page-title">'+i.title+"</h3>",r='<div class="n-page-lead">'+i.text+"</div>",d="",y=i.list.length,$.each(i.list,function(e,n){d+='<div class="n-list"><div class="n-list-title">'+n.title+'</div><div class="n-list-text-container animated running fadeIn"><div class="n-list-text-inner">'+n.text+"</div></div></div>"}),d='<div class="n-list-container">'+d+"</div>",t+='<div class="n-page"><div class="n-page-inner n-overflow-scroll-y n-overflow-scroll-force"><div class="n-overflow-scroll-y-inner">'+o+r+d+"</div></div></div>"):"image-text"===i.pageType&&(o='<h3 class="n-page-title">'+i.title+"</h3>",r='<div class="n-page-lead">'+i.text+"</div>",i.image&&""!==i.image&&(p='<div class="n-home-course-container"><div class="n-home-course-inner" style="background-image: url('+i.image+')"></div></div>'),t+='<div class="n-page"><div class="n-page-inner n-overflow-scroll-y"><div class="n-card-container n-overflow-scroll-y-inner"><div class="n-card-inner">'+p+o+r+"</div></div></div></div>"),f.fullScore+=u,f.len+=1,a+='<div class="n-progress" pageNum='+n+"></div>"}),t+='<div class="n-page n-page-last"><div class="n-page-inner n-overflow-scroll-y"><div class="n-overflow-scroll-y-inner"><h3 class="n-page-title"></h3><div class="n-page-lead"></div></div></div></div>',a+='<div class="n-progress" pageNum='+(f.len-1)+"></div>",f.len+=1,document.getElementById("n-course-inner").innerHTML=t,document.getElementById("n-progress-inner").innerHTML=a,i(0),f.courseIntro.courseId===n.course?r(f.courseIntro,o):$.get(c,function(e){r(e,o)})}).fail(function(){document.getElementById("n-course-inner").innerHTML='<div class="n-loading">加载失败，可能是我们的服务器不给力，也可能是您的网络不给力。</div>'})}function r(e,n){var t,s,i=0,o=[];f.courseTitle=e.title,$.each(e.content,function(e,s){$.each(s.sessions,function(e,s){s.id===n&&(t=i),o.push(s),i+=1})}),t<i-1?(s=t+1,f.nextSession=o[s].id):f.nextSession=""}function l(e){e.parent().addClass("done"),e.parent().parent().find(".n-list").removeClass("on"),e.parent().addClass("on"),e.append(" ")}function c(t){if(f.buttonDisable!==!0){var s,o,r=$(".n-page").eq(f.current),l="",c=0,d=0;"next"===t?(f.current===f.len-1?f.current=0:f.current<f.len-1&&(f.current+=1),i(f.current)):"confirm"===t?(s=r.find(".n-option.selected,.n-true.selected,.n-false.selected"),o=parseInt(s.attr("value"),10)||0,l=r.find(".n-page-point").html()||"",s.attr("value")>=1?(f.score+=o,s.addClass("is-correct animated running tada"),""!==l&&f.rightPoints.push(l)):(d=r.find(".n-option[value],.n-true[value],.n-false[value]").attr("value"),d=parseInt(d,10)||0,f.lostScore+=d,s.addClass("is-wrong animated running shake"),r.find(".n-option[value],.n-true[value],.n-false[value]").addClass("is-correct"),""!==l&&f.wrongPoints.push(l),c=1e4*f.lostScore/(f.fullScore*(100-f.passMark)),c>100?($("#n-battery-inner").height("100%"),$("#n-battery-container").addClass("failed")):($("#n-battery-inner").height(c+"%"),c>60&&$("#n-battery-container").addClass("alert")),$("#n-battery-container").addClass("used")),r.addClass("done"),f.action="next",document.getElementById("n-course-button").innerHTML=e("next")):"nextSession"===t?""!==f.nextSession?a(f.nextSession):n():"retry"===t&&a(f.currentSession)}}var d,u,v="0.0.3",g={scrollingX:!1,bouncing:!1,snapping:!1,scrollbars:!0,scrollBoundary:8,updateOnChanges:!0,updateOnWindowResize:!0,windowScrollingActiveFlag:"gFTScrollerActive"},p=[],f={action:"next",len:0,current:0,buttonDisable:!1,score:0,lostScore:0,fullScore:0,passMark:60,wrongPoints:[],rightPoints:[],nextSession:"",currentSession:"",page:"",courseTitle:"",courseId:"",hasSingleSession:!1,courseIntro:{}},m={language:"ch",text:{appTitle:{en:"ACADEMY",ch:"商学院"},start:{en:"START",ch:"开始"},back:{en:"BACK",ch:"返回"},close:{en:"CLOSE",ch:"关闭"},confirm:{en:"CONFIRM",ch:"确定"},next:{en:"NEXT",ch:"继续"},review:{en:"REVIEW",ch:"重温"},retry:{en:"RETRY",ch:"重试"},share:{en:"SHARE",ch:"分享"},nextSession:{en:"Next Session",ch:"下一节"},scoreIntro:{en:"You scored ",ch:"您答对"},pointsIntro:{en:"Key Points of This Session: ",ch:"本节的关键点："},trueOrFalse:{en:"True or False",ch:"判断"},trueStatement:{en:"True",ch:"正确"},falseStatement:{en:"False",ch:"错误"},prevItem:{en:"PREV",ch:"上一个"},nextItem:{en:"NEXT",ch:"下一个"}}};location.href.indexOf("isInSWIFT")>0&&document.getElementsByTagName("HTML")[0].classList.add("is-in-swift"),"addEventListener"in document&&document.addEventListener("DOMContentLoaded",function(){FastClick.attach(document.body)},!1),$("body").on("click",".n-header__back",function(){n()}),$("body").on("click",".n-header__close",function(){t()}),$("body").on("click",".n-course-link",function(){return o(this.getAttribute("course-id"),this.title),!1}),$("body").on("click",".n-session-title",function(){return a(this.getAttribute("session-id"),this.innerHTML),!1}),$("body").on("click","#n-course-button",function(){c(f.action)}),$("body").on("click",".n-option, .n-true, .n-false",function(){if($(this).parentsUntil("n-page").parent().hasClass("done")!==!0){$(this).parent().find(".n-option,.n-true, .n-false").removeClass("selected"),$(this).addClass("selected");var n=$("#n-course-button");n.html(e("confirm")),n.removeClass("disabled"),f.action="confirm",f.buttonDisable=!1}}),$("body").on("click",".n-list-title",function(){l($(this))}),$("body").on("click",".n-progress, .n-progress.done",function(){var e=$(this).attr("pageNum");e=parseInt(e,10),i(e)}),$("body").on("click","#n-header-title",function(e){e.clientY>=0&&e.clientY<=100&&(""===f.page?u.scrollTo(0,0,500):"course"===f.page?d.scrollTo(0,0,500):"session"===f.page&&"object"===_typeof(p[f.current])&&p[f.current].scrollTo(0,0,500))}),$.get("api/index.json",function(e){var n=document.getElementById("start-screen"),t="";"object"===("undefined"==typeof e?"undefined":_typeof(e))&&($.each(e,function(e,s){var i,o,a,r,l,c,d,u,v,g;i="n-home-course-green",o="n-home-course-inner "+i,r=e%8,a="s-"+r,c=e%16,l="m-"+c,u=e%16,d="l-"+u,v="n-home-course-container "+a+" "+l+" "+d,g='<div class="clearfloat '+a+" "+l+" "+d+'"></div>',t+='<a course-id="course/'+s.id+'" title="'+s.title+'" class="n-course-link"><div class="'+v+'"><div class="'+o+'" /*style="background-image: url('+s.image+"?"+s.id+')"*/><div class="n-home-course-title">'+s.title+"</div></div></div></a>"+g,n.className="start-screen fadeOut animated running"}),t+='<div class="n-version">版本号：'+v+"</div>",document.getElementById("home-content").innerHTML=t,u=new FTScroller(document.getElementById("home-content-scroller"),g),setTimeout(function(){n.parentNode.removeChild(n)},1e3))}),console.log("jaury dfa"),document.getElementById("n-header-title").innerHTML=e("appTitle"),document.getElementById("n-header__back").innerHTML=e("back"),document.addEventListener("touchmove",function(e){e.preventDefault()})}();